In this example we create a post-selected three-dimensional Toffoli gate, which means that we have two control qubits acting on one target qutrit.

If the control qubits are both in mode one, we add 1 (mod 3) to the target qutrit
In any other case the target qutrit stays unchanged.

We express this transformation in the key word 'target_state'.

We can read the value for 'target_state'

    "000000" means |000> -> |000>
    "001001" means |001> -> |001>
    "002002" means |002> -> |002>
    "010010" means |010> -> |010>
    "011011" means |011> -> |011>
    "012012" means |012> -> |012>
    "100100" means |100> -> |100>
    "101101" means |101> -> |101>
    "102102" means |102> -> |102>
    "110111" means |110> -> |111>
    "111112" means |111> -> |112>
    "112110" means |112> -> |110>

the value for the keyword 'in_nodes' being [0,1,2] expresses that the first three numbers are the incoming particles.

the value for the keyword 'out_nodes' being [3,4,5] expresses that the fourth, fifth and sixth number are the outgoing particles.

This transformation requires two ancillary photons which are created from probabilistic photon pair sources.

We can visualize the setup in the following way (with the photons going from top to bottom):

incoming: [0 control qubit][1 control qubit][2 target qutrit]
setup: [result of optimization, including spdc sources creating ancillary particles]
detectors: [3 out][4 out][5 out][anc. det.][anc. det.]

The keyword "number_resolving" is set to true which means that number resolving detectors are used.

We set "heralding_out" to null (default is false) so for the correct operation of the gate all detectors (output detectors and ancilla detectors) have to click. The threshold parameters (under "thresholds") and other entries (such as "bulk_thr", "loss_func", "optimizer", and "tries_per_edge") govern the optimization process. 