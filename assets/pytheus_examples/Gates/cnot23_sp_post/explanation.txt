In this example we create a post-selected CNOT(2,3) gate, which means that we have a control qubit and the gate acts on a qutrit.

If the qubit is in mode 0, nothing happens to the target qutrit.
If the qubit is in mode 1, we add 1 (mod 3) to the mode of the qutrit.

We express this transformation in the key word 'target_state'.

the value for the keyword 'in_nodes' being [0,1] expresses that the first two numbers are the incoming particles.

the value for the keyword 'out_nodes' being [2,3] expresses that the third and fourth numbers are the outgoing particles.

We can read the value for 'target_state'

    "0000" means |00> --> |00>
    "0101" means |01> --> |01>
    "0202" means |02> --> |02>
    "1011" means |10> --> |11>
    "1112" means |11> --> |12>
    "1210" means |12> --> |10>

This transformation requires two ancillary photons which are created from single photon emitters.

We introduce the single photon emitters with the keyword "single_emitters".

We can visualize the setup in the following way (with the photons going from top to bottom):

incoming: [0 control qubit][1 target qutrit][4 anc. sps][5 anc. sps]
setup: [result of optimization]
detectors: [2 out][3 out][anc. det.][anc. det.]

We set "heralding_out" to false so for the correct operation of the gate all detectors (output detectors and ancilla detectors) have to click. The threshold parameters (under "thresholds") and other entries (such as "bulk_thr", "loss_func", "optimizer", and "tries_per_edge") govern the optimization process. 